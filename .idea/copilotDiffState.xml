<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/SYUcap/build.gradle">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/SYUcap/build.gradle" />
              <option name="originalContent" value="plugins {&#10;&#9;id 'java'&#10;&#9;id 'org.springframework.boot' version '3.5.6'&#10;&#9;id 'io.spring.dependency-management' version '1.1.7'&#10;}&#10;&#10;group = 'com.SYUcap'&#10;version = '0.0.1-SNAPSHOT'&#10;description = 'Demo project for Spring Boot'&#10;&#10;java {&#10;&#9;toolchain {&#10;&#9;&#9;languageVersion = JavaLanguageVersion.of(17)&#10;&#9;}&#10;}&#10;&#10;repositories {&#10;&#9;mavenCentral()&#10;}&#10;&#10;&#10;&#10;dependencies {&#10;&#9;implementation 'org.springframework.boot:spring-boot-starter-web'&#10;&#9;developmentOnly 'org.springframework.boot:spring-boot-devtools'&#10;&#9;testImplementation 'org.springframework.boot:spring-boot-starter-test'&#10;&#9;testRuntimeOnly 'org.junit.platform:junit-platform-launcher'&#10;&#9;implementation 'org.springframework.boot:spring-boot-starter-thymeleaf'&#10;&#9;runtimeOnly 'com.mysql:mysql-connector-j'&#10;&#9;implementation 'org.springframework.boot:spring-boot-starter-data-jpa'&#10;&#9;compileOnly 'org.projectlombok:lombok'&#10;&#9;annotationProcessor 'org.projectlombok:lombok'&#10;&#9;implementation 'org.springframework.boot:spring-boot-starter-security'&#10;&#9;implementation 'org.thymeleaf.extras:thymeleaf-extras-springsecurity6:3.1.1.RELEASE'&#10;}&#10;&#10;tasks.named('test') {&#10;&#9;useJUnitPlatform()&#10;}&#10;" />
              <option name="updatedContent" value="plugins {&#10;&#9;id 'java'&#10;&#9;id 'org.springframework.boot' version '3.5.6'&#10;&#9;id 'io.spring.dependency-management' version '1.1.7'&#10;}&#10;&#10;group = 'com.SYUcap'&#10;version = '0.0.1-SNAPSHOT'&#10;description = 'Demo project for Spring Boot'&#10;&#10;java {&#10;&#9;toolchain {&#10;&#9;&#9;languageVersion = JavaLanguageVersion.of(17)&#10;&#9;}&#10;}&#10;&#10;repositories {&#10;&#9;mavenCentral()&#10;}&#10;&#10;&#10;&#10;dependencies {&#10;&#9;implementation 'org.springframework.boot:spring-boot-starter-web'&#10;&#9;developmentOnly 'org.springframework.boot:spring-boot-devtools'&#10;&#9;testImplementation 'org.springframework.boot:spring-boot-starter-test'&#10;&#9;testRuntimeOnly 'org.junit.platform:junit-platform-launcher'&#10;&#9;implementation 'org.springframework.boot:spring-boot-starter-thymeleaf'&#10;&#9;runtimeOnly 'com.mysql:mysql-connector-j'&#10;&#9;implementation 'org.springframework.boot:spring-boot-starter-data-jpa'&#10;&#9;compileOnly 'org.projectlombok:lombok'&#10;&#9;annotationProcessor 'org.projectlombok:lombok'&#10;&#9;implementation 'org.springframework.boot:spring-boot-starter-security'&#10;&#9;implementation 'org.thymeleaf.extras:thymeleaf-extras-springsecurity6:3.1.1.RELEASE'&#10;&#9;// Add test dependencies for integration testing with security &amp; H2&#10;&#9;testImplementation 'org.springframework.security:spring-security-test'&#10;&#9;testRuntimeOnly 'com.h2database:h2'&#10;}&#10;&#10;tasks.named('test') {&#10;&#9;useJUnitPlatform()&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/SYUcap/src/main/java/com/SYUcap/SYUcap/GlobalExceptionHandler.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/SYUcap/src/main/java/com/SYUcap/SYUcap/GlobalExceptionHandler.java" />
              <option name="originalContent" value="package com.SYUcap.SYUcap;&#10;&#10;import org.springframework.http.HttpStatus;&#10;import org.springframework.http.ResponseEntity;&#10;import org.springframework.web.bind.annotation.ControllerAdvice;&#10;import org.springframework.web.bind.annotation.ExceptionHandler;&#10;&#10;@ControllerAdvice // 모든 @Controller에 대해 전역적으로 예외를 처리&#10;public class GlobalExceptionHandler {&#10;&#10;    // IllegalArgumentException이 발생하면 이 메서드가 대신 처리&#10;    @ExceptionHandler(IllegalArgumentException.class)&#10;    public ResponseEntity&lt;String&gt; handleIllegalArgument(IllegalArgumentException ex) {&#10;        // 400 (Bad Request) 상태 코드와 예외 메시지를 본문에 담아 반환&#10;        return ResponseEntity.status(HttpStatus.BAD_REQUEST).body(ex.getMessage());&#10;    }&#10;}" />
              <option name="updatedContent" value="package com.SYUcap.SYUcap;&#10;&#10;import org.springframework.dao.DataIntegrityViolationException;&#10;import org.springframework.http.HttpStatus;&#10;import org.springframework.http.ResponseEntity;&#10;import org.springframework.web.bind.annotation.ControllerAdvice;&#10;import org.springframework.web.bind.annotation.ExceptionHandler;&#10;&#10;@ControllerAdvice // 모든 @Controller에 대해 전역적으로 예외를 처리&#10;public class GlobalExceptionHandler {&#10;&#10;    // IllegalArgumentException이 발생하면 이 메서드가 대신 처리&#10;    @ExceptionHandler(IllegalArgumentException.class)&#10;    public ResponseEntity&lt;String&gt; handleIllegalArgument(IllegalArgumentException ex) {&#10;        // 400 (Bad Request) 상태 코드와 예외 메시지를 본문에 담아 반환&#10;        return ResponseEntity.status(HttpStatus.BAD_REQUEST).body(ex.getMessage());&#10;    }&#10;&#10;    // DataIntegrityViolationException이 발생하면 이 메서드가 대신 처리&#10;    @ExceptionHandler(DataIntegrityViolationException.class)&#10;    public ResponseEntity&lt;String&gt; handleDataIntegrity(DataIntegrityViolationException ex) {&#10;        // 400 (Bad Request) 상태 코드와 사용자 친화적인 메시지를 본문에 담아 반환&#10;        return ResponseEntity.status(HttpStatus.BAD_REQUEST).body(&quot;이미 존재하는 아이디입니다.&quot;);&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/SYUcap/src/main/resources/static/mypage.css">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/SYUcap/src/main/resources/static/mypage.css" />
              <option name="updatedContent" value="/* 마이페이지 전용 스타일 */&#10;* {&#10;    margin: 0;&#10;    padding: 0;&#10;    box-sizing: border-box;&#10;}&#10;&#10;body {&#10;    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;&#10;    background: #f5f5f5;&#10;    min-height: 100vh;&#10;    padding: 20px;&#10;}&#10;&#10;.card {&#10;    max-width: 400px;&#10;    margin: 0 auto;&#10;    background: white;&#10;    border-radius: 12px;&#10;    box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);&#10;    padding: 24px;&#10;    position: relative;&#10;}&#10;&#10;h1 {&#10;    font-size: 24px;&#10;    font-weight: 600;&#10;    color: #333;&#10;    text-align: center;&#10;    margin-bottom: 24px;&#10;}&#10;&#10;/* 탭 스타일 */&#10;.tabs {&#10;    display: flex;&#10;    border-bottom: 1px solid #e9ecef;&#10;    margin-bottom: 24px;&#10;}&#10;&#10;.tabs a {&#10;    flex: 1;&#10;    padding: 12px 16px;&#10;    text-decoration: none;&#10;    color: #6c757d;&#10;    text-align: center;&#10;    border-bottom: 2px solid transparent;&#10;    transition: all 0.2s;&#10;}&#10;&#10;.tabs a.active {&#10;    color: #007bff;&#10;    border-bottom-color: #007bff;&#10;    font-weight: 500;&#10;}&#10;&#10;.tabs a:hover {&#10;    color: #007bff;&#10;    background: #f8f9fa;&#10;}&#10;&#10;/* 아바타 스타일 */&#10;.avatar-wrap {&#10;    display: flex;&#10;    justify-content: center;&#10;    margin-bottom: 32px;&#10;    position: relative;&#10;}&#10;&#10;.avatar {&#10;    width: 80px;&#10;    height: 80px;&#10;    border-radius: 50%;&#10;    background: #e9ecef;&#10;    display: flex;&#10;    align-items: center;&#10;    justify-content: center;&#10;}&#10;&#10;.avatar.placeholder {&#10;    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);&#10;}&#10;&#10;.avatar svg {&#10;    fill: white;&#10;}&#10;&#10;.edit-badge {&#10;    position: absolute;&#10;    bottom: 4px;&#10;    right: calc(50% - 48px);&#10;    width: 28px;&#10;    height: 28px;&#10;    background: white;&#10;    border-radius: 50%;&#10;    display: flex;&#10;    align-items: center;&#10;    justify-content: center;&#10;    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);&#10;    cursor: pointer;&#10;    transition: transform 0.2s;&#10;}&#10;&#10;.edit-badge:hover {&#10;    transform: scale(1.1);&#10;}&#10;&#10;/* 폼 요소들 */&#10;.row {&#10;    display: flex;&#10;    align-items: center;&#10;    margin-bottom: 16px;&#10;    gap: 12px;&#10;}&#10;&#10;.label {&#10;    width: 80px;&#10;    font-weight: 500;&#10;    color: #495057;&#10;    font-size: 14px;&#10;}&#10;&#10;.input {&#10;    flex: 1;&#10;    padding: 10px 12px;&#10;    border: 1px solid #dee2e6;&#10;    border-radius: 6px;&#10;    font-size: 14px;&#10;    background: #f8f9fa;&#10;    color: #6c757d;&#10;}&#10;&#10;.input:focus {&#10;    outline: none;&#10;    border-color: #007bff;&#10;    background: white;&#10;    color: #333;&#10;}&#10;&#10;.btn {&#10;    padding: 8px 16px;&#10;    border: 1px solid #007bff;&#10;    border-radius: 6px;&#10;    background: white;&#10;    color: #007bff;&#10;    font-size: 12px;&#10;    font-weight: 500;&#10;    cursor: pointer;&#10;    transition: all 0.2s;&#10;    white-space: nowrap;&#10;}&#10;&#10;.btn:hover {&#10;    background: #007bff;&#10;    color: white;&#10;}&#10;&#10;.btn-primary {&#10;    background: #007bff;&#10;    color: white;&#10;}&#10;&#10;.btn-primary:hover {&#10;    background: #0056b3;&#10;}&#10;&#10;.btn-danger {&#10;    border-color: #dc3545;&#10;    color: #dc3545;&#10;}&#10;&#10;.btn-danger:hover {&#10;    background: #dc3545;&#10;    color: white;&#10;}&#10;&#10;/* 로그아웃 버튼 */&#10;.logout {&#10;    width: 100%;&#10;    padding: 12px;&#10;    border: none;&#10;    border-radius: 8px;&#10;    background: #dc3545;&#10;    color: white;&#10;    font-weight: 500;&#10;    cursor: pointer;&#10;    margin-top: 24px;&#10;    transition: background 0.2s;&#10;}&#10;&#10;.logout:hover {&#10;    background: #c82333;&#10;}&#10;&#10;/* 네비게이션 바 */&#10;.bottom-nav {&#10;    position: fixed;&#10;    bottom: 0;&#10;    left: 0;&#10;    right: 0;&#10;    background: white;&#10;    border-top: 1px solid #dee2e6;&#10;    display: flex;&#10;    padding: 12px 0;&#10;}&#10;&#10;.nav-item {&#10;    flex: 1;&#10;    display: flex;&#10;    flex-direction: column;&#10;    align-items: center;&#10;    text-decoration: none;&#10;    color: #6c757d;&#10;    font-size: 12px;&#10;    gap: 4px;&#10;}&#10;&#10;.nav-item.active {&#10;    color: #007bff;&#10;}&#10;&#10;.nav-item svg {&#10;    width: 24px;&#10;    height: 24px;&#10;}&#10;&#10;/* 설정 페이지 전용 스타일 */&#10;.settings-section {&#10;    margin-bottom: 24px;&#10;}&#10;&#10;.settings-section h3 {&#10;    font-size: 16px;&#10;    font-weight: 600;&#10;    color: #333;&#10;    margin-bottom: 16px;&#10;    padding-bottom: 8px;&#10;    border-bottom: 1px solid #e9ecef;&#10;}&#10;&#10;.setting-item {&#10;    display: flex;&#10;    justify-content: space-between;&#10;    align-items: center;&#10;    padding: 12px 0;&#10;    border-bottom: 1px solid #f8f9fa;&#10;}&#10;&#10;.setting-item:last-child {&#10;    border-bottom: none;&#10;}&#10;&#10;.setting-label {&#10;    font-size: 14px;&#10;    color: #333;&#10;}&#10;&#10;.setting-description {&#10;    font-size: 12px;&#10;    color: #6c757d;&#10;    margin-top: 2px;&#10;}&#10;&#10;.toggle {&#10;    position: relative;&#10;    width: 44px;&#10;    height: 24px;&#10;    background: #dee2e6;&#10;    border-radius: 12px;&#10;    cursor: pointer;&#10;    transition: background 0.2s;&#10;}&#10;&#10;.toggle.active {&#10;    background: #007bff;&#10;}&#10;&#10;.toggle::after {&#10;    content: '';&#10;    position: absolute;&#10;    top: 2px;&#10;    left: 2px;&#10;    width: 20px;&#10;    height: 20px;&#10;    background: white;&#10;    border-radius: 50%;&#10;    transition: transform 0.2s;&#10;}&#10;&#10;.toggle.active::after {&#10;    transform: translateX(20px);&#10;}&#10;&#10;/* 반응형 디자인 */&#10;@media (max-width: 480px) {&#10;    body {&#10;        padding: 12px;&#10;    }&#10;    &#10;    .card {&#10;        padding: 20px;&#10;    }&#10;    &#10;    .row {&#10;        flex-direction: column;&#10;        align-items: stretch;&#10;        gap: 8px;&#10;    }&#10;    &#10;    .label {&#10;        width: 100%;&#10;    }&#10;    &#10;    .btn {&#10;        align-self: flex-end;&#10;        margin-top: 4px;&#10;    }&#10;}" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/SYUcap/src/main/resources/templates/recent-posts.html">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/SYUcap/src/main/resources/templates/recent-posts.html" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/SYUcap/src/test/java/com/SYUcap/SYUcap/User/UserControllerTest.java">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/SYUcap/src/test/java/com/SYUcap/SYUcap/User/UserControllerTest.java" />
              <option name="originalContent" value="package com.SYUcap.SYUcap.User;&#10;&#10;import org.junit.jupiter.api.DisplayName;&#10;import org.junit.jupiter.api.Test;&#10;import org.springframework.beans.factory.annotation.Autowired;&#10;import org.springframework.boot.test.autoconfigure.web.servlet.AutoConfigureMockMvc;&#10;import org.springframework.boot.test.context.SpringBootTest;&#10;import org.springframework.security.crypto.password.PasswordEncoder;&#10;import org.springframework.test.context.ActiveProfiles;&#10;import org.springframework.test.web.servlet.MockMvc;&#10;import org.springframework.transaction.annotation.Transactional;&#10;&#10;import java.util.concurrent.CountDownLatch;&#10;import java.util.concurrent.ExecutorService;&#10;import java.util.concurrent.Executors;&#10;import java.util.concurrent.TimeUnit;&#10;import java.util.concurrent.atomic.AtomicInteger;&#10;import java.util.stream.IntStream;&#10;&#10;import static org.assertj.core.api.Assertions.assertThat;&#10;import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.post;&#10;import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.*;&#10;&#10;@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT)&#10;@AutoConfigureMockMvc // 보안 필터 활성화 (로그인 플로우 검증)&#10;@ActiveProfiles(&quot;test&quot;)&#10;@Transactional&#10;public class UserControllerTest {&#10;&#10;    @Autowired MockMvc mockMvc;&#10;    @Autowired UserRepository userRepository;&#10;    @Autowired PasswordEncoder passwordEncoder;&#10;&#10;    @Test&#10;    @DisplayName(&quot;스프링 컨텍스트 로드&quot;)&#10;    void contextLoads() { }&#10;&#10;    @Test&#10;    @DisplayName(&quot;회원가입 성공 시 로그인 페이지 이동&quot;)&#10;    void signup_success_moves_to_login_page() throws Exception {&#10;        // given&#10;        String userId = &quot;joinUser01&quot;;&#10;        String rawPw = &quot;Passw0rd!&quot;;&#10;        String confirm = &quot;Passw0rd!&quot;;&#10;        String name = &quot;Tester&quot;;&#10;        // when&#10;        var result = mockMvc.perform(post(&quot;/signup&quot;)&#10;                        .param(&quot;userId&quot;, userId)&#10;                        .param(&quot;password&quot;, rawPw)&#10;                        .param(&quot;passwordConfirm&quot;, confirm)&#10;                        .param(&quot;userName&quot;, name))&#10;&#10;                .andExpect(status().isOk())&#10;                .andReturn();&#10;        // then (추가 검증: 로그인 페이지 콘텐츠 일부 포함 여부)&#10;        assertThat(result.getResponse().getContentAsString()).contains(&quot;로그인&quot;);&#10;    }&#10;&#10;    @Test&#10;    @DisplayName(&quot;회원가입 시 비밀번호 암호화 성공&quot;)&#10;    void signup_password_encrypted() throws Exception {&#10;        // given&#10;        String userId = &quot;encryptUser01&quot;;&#10;        String rawPw = &quot;Abcdef1!&quot;;&#10;        String confirm = rawPw;&#10;        String name = &quot;동현&quot;;&#10;        // when&#10;        mockMvc.perform(post(&quot;/signup&quot;)&#10;                .param(&quot;userId&quot;, userId)&#10;                .param(&quot;password&quot;, rawPw)&#10;                .param(&quot;passwordConfirm&quot;, confirm)&#10;                .param(&quot;userName&quot;, name))&#10;                .andExpect(status().isOk());&#10;        // then&#10;        Users saved = userRepository.findByUserId(userId).orElseThrow();&#10;        assertThat(saved.getPassword()).isNotEqualTo(rawPw);&#10;        assertThat(passwordEncoder.matches(rawPw, saved.getPassword())).isTrue();&#10;    }&#10;&#10;    @Test&#10;    @DisplayName(&quot;로그인 성공 시 /home 리다이렉트&quot;)&#10;    void login_success_redirects_home() throws Exception {&#10;        // given (사전 가입)&#10;        String userId = &quot;loginUser01&quot;;&#10;        String rawPw = &quot;Strong1!&quot;;&#10;        String confirm = rawPw;&#10;        String name = &quot;로그인&quot;;&#10;        mockMvc.perform(post(&quot;/signup&quot;)&#10;                .param(&quot;userId&quot;, userId)&#10;                .param(&quot;password&quot;, rawPw)&#10;                .param(&quot;passwordConfirm&quot;, confirm)&#10;                .param(&quot;userName&quot;, name))&#10;                .andExpect(status().isOk());&#10;        // when/then&#10;        mockMvc.perform(post(&quot;/login&quot;)&#10;                .param(&quot;userId&quot;, userId)&#10;                .param(&quot;password&quot;, rawPw))&#10;                .andExpect(status().is3xxRedirection())&#10;                .andExpect(redirectedUrl(&quot;/home&quot;));&#10;    }&#10;    @Test&#10;    @DisplayName(&quot;회원가입 버튼 연속 클릭시 중복 저장 방지&quot;)&#10;    void signup_double_submit_prevents_duplicate() throws Exception {&#10;        // given: 첫 요청으로 가입&#10;        String userId = &quot;doubleClickUser01&quot;;&#10;        String rawPw = &quot;Click1!&quot;;&#10;        String confirm = rawPw;&#10;        String name = &quot;더블&quot;;&#10;        mockMvc.perform(post(&quot;/signup&quot;)&#10;                .param(&quot;userId&quot;, userId)&#10;                .param(&quot;password&quot;, rawPw)&#10;                .param(&quot;passwordConfirm&quot;, confirm)&#10;                .param(&quot;userName&quot;, name))&#10;                .andExpect(status().isOk());&#10;&#10;        // when: 동일 데이터로 즉시 두 번째 제출 (연속 클릭 시나리오)&#10;        mockMvc.perform(post(&quot;/signup&quot;)&#10;                .param(&quot;userId&quot;, userId)&#10;                .param(&quot;password&quot;, rawPw)&#10;                .param(&quot;passwordConfirm&quot;, confirm)&#10;                .param(&quot;userName&quot;, name))&#10;                .andExpect(status().isBadRequest())&#10;                .andExpect(content().string(&quot;이미 존재하는 아이디입니다.&quot;));&#10;&#10;        // then: 해당 userId로 DB에 하나만 존재&#10;        long count = userRepository.findAll().stream()&#10;                .filter(u -&gt; userId.equals(u.getUserId()))&#10;                .count();&#10;        assertThat(count).isEqualTo(1);&#10;    }&#10;&#10;    @Test&#10;    @DisplayName(&quot;동시 가입(동일 아이디): 하나만 성공, 나머지는 400, DB에는 1건&quot;)&#10;    void concurrent_signup_same_userId_only_one_saved() throws Exception {&#10;        // given&#10;        String userId = &quot;concurrentUser01&quot;;&#10;        String rawPw = &quot;Passw0rd!&quot;;&#10;        String name = &quot;동시&quot;;&#10;        int threads = 10;&#10;        ExecutorService pool = Executors.newFixedThreadPool(threads);&#10;        CountDownLatch start = new CountDownLatch(1);&#10;        CountDownLatch done = new CountDownLatch(threads);&#10;        AtomicInteger ok = new AtomicInteger();&#10;        AtomicInteger bad = new AtomicInteger();&#10;        AtomicInteger errors = new AtomicInteger();&#10;&#10;        // when&#10;        IntStream.range(0, threads).forEach(i -&gt; pool.submit(() -&gt; {&#10;            try {&#10;                start.await();&#10;                var res = mockMvc.perform(post(&quot;/signup&quot;)&#10;                                .param(&quot;userId&quot;, userId)&#10;                                .param(&quot;password&quot;, rawPw)&#10;                                .param(&quot;passwordConfirm&quot;, rawPw)&#10;                                .param(&quot;userName&quot;, name))&#10;                        .andReturn();&#10;                int status = res.getResponse().getStatus();&#10;                if (status == 200) ok.incrementAndGet();&#10;                else if (status == 400) bad.incrementAndGet();&#10;                else errors.incrementAndGet();&#10;            } catch (Exception e) {&#10;                errors.incrementAndGet();&#10;            } finally {&#10;                done.countDown();&#10;            }&#10;        }));&#10;        start.countDown();&#10;        done.await(10, TimeUnit.SECONDS);&#10;        pool.shutdownNow();&#10;&#10;        // then&#10;        assertThat(ok.get()).isEqualTo(1);&#10;        assertThat(bad.get()).isEqualTo(threads - 1);&#10;        assertThat(errors.get()).isEqualTo(0);&#10;        long count = userRepository.findAll().stream().filter(u -&gt; userId.equals(u.getUserId())).count();&#10;        assertThat(count).isEqualTo(1);&#10;    }&#10;&#10;    @Test&#10;    @DisplayName(&quot;동시 가입(서로 다른 아이디): 모두 성공, DB에 모두 저장&quot;)&#10;    void concurrent_signup_distinct_userIds_all_saved() throws Exception {&#10;        // given&#10;        int threads = 100; &#10;        ExecutorService pool = Executors.newFixedThreadPool(threads);&#10;        CountDownLatch start = new CountDownLatch(1);&#10;        CountDownLatch done = new CountDownLatch(threads);&#10;        AtomicInteger ok = new AtomicInteger();&#10;        AtomicInteger errors = new AtomicInteger();&#10;&#10;        // when&#10;        IntStream.range(0, threads).forEach(i -&gt; pool.submit(() -&gt; {&#10;            String userId = &quot;concurrentDistinct&quot; + i;&#10;            try {&#10;                start.await();&#10;                var res = mockMvc.perform(post(&quot;/signup&quot;)&#10;                                .param(&quot;userId&quot;, userId)&#10;                                .param(&quot;password&quot;, &quot;Pw&quot; + i + &quot;!Ab1&quot;)&#10;                                .param(&quot;passwordConfirm&quot;, &quot;Pw&quot; + i + &quot;!Ab1&quot;)&#10;                                .param(&quot;userName&quot;, &quot;U&quot; + i))&#10;                        .andReturn();&#10;                int status = res.getResponse().getStatus();&#10;                if (status == 200) ok.incrementAndGet();&#10;                else errors.incrementAndGet();&#10;            } catch (Exception e) {&#10;                errors.incrementAndGet();&#10;            } finally {&#10;                done.countDown();&#10;            }&#10;        }));&#10;        long startNs = System.nanoTime();&#10;        start.countDown();&#10;        boolean finished = done.await(30, TimeUnit.SECONDS); // 완료 여부&#10;        long elapsedMs = (System.nanoTime() - startNs) / 1_000_000L;&#10;        pool.shutdownNow();&#10;        log.info(&quot;서로다른아이디 동시가입 총 경과(ms): {} / finished: {}&quot;, elapsedMs, finished);&#10;&#10;        // then&#10;        assertThat(finished).as(&quot;30초 내 전체 스레드 종료&quot;).isTrue();&#10;        assertThat(elapsedMs).isLessThanOrEqualTo(30_000);&#10;        assertThat(ok.get()).isEqualTo(threads);&#10;        assertThat(errors.get()).isEqualTo(0);&#10;        long saved = userRepository.findAll().stream()&#10;                .filter(u -&gt; u.getUserId() != null &amp;&amp; u.getUserId().startsWith(&quot;concurrentDistinct&quot;))&#10;                .count();&#10;        assertThat(saved).isEqualTo(threads);&#10;    }&#10;}&#10;&#10;" />
              <option name="updatedContent" value="package com.SYUcap.SYUcap.User;&#10;&#10;import org.junit.jupiter.api.DisplayName;&#10;import org.junit.jupiter.api.Test;&#10;import org.springframework.beans.factory.annotation.Autowired;&#10;import org.springframework.boot.test.autoconfigure.web.servlet.AutoConfigureMockMvc;&#10;import org.springframework.boot.test.context.SpringBootTest;&#10;import org.springframework.security.crypto.password.PasswordEncoder;&#10;import org.springframework.test.context.ActiveProfiles;&#10;import org.springframework.test.web.servlet.MockMvc;&#10;import org.springframework.transaction.annotation.Transactional;&#10;&#10;import java.util.concurrent.CountDownLatch;&#10;import java.util.concurrent.ExecutorService;&#10;import java.util.concurrent.Executors;&#10;import java.util.concurrent.TimeUnit;&#10;import java.util.concurrent.atomic.AtomicInteger;&#10;import java.util.stream.IntStream;&#10;&#10;import static org.assertj.core.api.Assertions.assertThat;&#10;import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.post;&#10;import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.*;&#10;import org.slf4j.Logger;&#10;import org.slf4j.LoggerFactory;&#10;&#10;@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT)&#10;@AutoConfigureMockMvc // 보안 필터 활성화 (로그인 플로우 검증)&#10;@ActiveProfiles(&quot;test&quot;)&#10;@Transactional&#10;public class UserControllerTest {&#10;&#10;    private static final Logger log = LoggerFactory.getLogger(UserControllerTest.class);&#10;&#10;    @Autowired MockMvc mockMvc;&#10;    @Autowired UserRepository userRepository;&#10;    @Autowired PasswordEncoder passwordEncoder;&#10;&#10;    @Test&#10;    @DisplayName(&quot;스프링 컨텍스트 로드&quot;)&#10;    void contextLoads() { }&#10;&#10;    @Test&#10;    @DisplayName(&quot;회원가입 성공 시 로그인 페이지 이동&quot;)&#10;    void signup_success_moves_to_login_page() throws Exception {&#10;        // given&#10;        String userId = &quot;joinUser01&quot;;&#10;        String rawPw = &quot;Passw0rd!&quot;;&#10;        String confirm = &quot;Passw0rd!&quot;;&#10;        String name = &quot;Tester&quot;;&#10;        // when&#10;        var result = mockMvc.perform(post(&quot;/signup&quot;)&#10;                        .param(&quot;userId&quot;, userId)&#10;                        .param(&quot;password&quot;, rawPw)&#10;                        .param(&quot;passwordConfirm&quot;, confirm)&#10;                        .param(&quot;userName&quot;, name))&#10;&#10;                .andExpect(status().isOk())&#10;                .andReturn();&#10;        // then (추가 검증: 로그인 페이지 콘텐츠 일부 포함 여부)&#10;        assertThat(result.getResponse().getContentAsString()).contains(&quot;로그인&quot;);&#10;    }&#10;&#10;    @Test&#10;    @DisplayName(&quot;회원가입 시 비밀번호 암호화 성공&quot;)&#10;    void signup_password_encrypted() throws Exception {&#10;        // given&#10;        String userId = &quot;encryptUser01&quot;;&#10;        String rawPw = &quot;Abcdef1!&quot;;&#10;        String confirm = rawPw;&#10;        String name = &quot;동현&quot;;&#10;        // when&#10;        mockMvc.perform(post(&quot;/signup&quot;)&#10;                .param(&quot;userId&quot;, userId)&#10;                .param(&quot;password&quot;, rawPw)&#10;                .param(&quot;passwordConfirm&quot;, confirm)&#10;                .param(&quot;userName&quot;, name))&#10;                .andExpect(status().isOk());&#10;        // then&#10;        Users saved = userRepository.findByUserId(userId).orElseThrow();&#10;        assertThat(saved.getPassword()).isNotEqualTo(rawPw);&#10;        assertThat(passwordEncoder.matches(rawPw, saved.getPassword())).isTrue();&#10;    }&#10;&#10;    @Test&#10;    @DisplayName(&quot;로그인 성공 시 /home 리다이렉트&quot;)&#10;    void login_success_redirects_home() throws Exception {&#10;        // given (사전 가입)&#10;        String userId = &quot;loginUser01&quot;;&#10;        String rawPw = &quot;Strong1!&quot;;&#10;        String confirm = rawPw;&#10;        String name = &quot;로그인&quot;;&#10;        mockMvc.perform(post(&quot;/signup&quot;)&#10;                .param(&quot;userId&quot;, userId)&#10;                .param(&quot;password&quot;, rawPw)&#10;                .param(&quot;passwordConfirm&quot;, confirm)&#10;                .param(&quot;userName&quot;, name))&#10;                .andExpect(status().isOk());&#10;        // when/then&#10;        mockMvc.perform(post(&quot;/login&quot;)&#10;                .param(&quot;userId&quot;, userId)&#10;                .param(&quot;password&quot;, rawPw))&#10;                .andExpect(status().is3xxRedirection())&#10;                .andExpect(redirectedUrl(&quot;/home&quot;));&#10;    }&#10;    @Test&#10;    @DisplayName(&quot;회원가입 버튼 연속 클릭시 중복 저장 방지&quot;)&#10;    void signup_double_submit_prevents_duplicate() throws Exception {&#10;        // given: 첫 요청으로 가입&#10;        String userId = &quot;doubleClickUser01&quot;;&#10;        String rawPw = &quot;Click1!&quot;;&#10;        String confirm = rawPw;&#10;        String name = &quot;더블&quot;;&#10;        mockMvc.perform(post(&quot;/signup&quot;)&#10;                .param(&quot;userId&quot;, userId)&#10;                .param(&quot;password&quot;, rawPw)&#10;                .param(&quot;passwordConfirm&quot;, confirm)&#10;                .param(&quot;userName&quot;, name))&#10;                .andExpect(status().isOk());&#10;&#10;        // when: 동일 데이터로 즉시 두 번째 제출 (연속 클릭 시나리오)&#10;        mockMvc.perform(post(&quot;/signup&quot;)&#10;                .param(&quot;userId&quot;, userId)&#10;                .param(&quot;password&quot;, rawPw)&#10;                .param(&quot;passwordConfirm&quot;, confirm)&#10;                .param(&quot;userName&quot;, name))&#10;                .andExpect(status().isBadRequest())&#10;                .andExpect(content().string(&quot;이미 존재하는 아이디입니다.&quot;));&#10;&#10;        // then: 해당 userId로 DB에 하나만 존재&#10;        long count = userRepository.findAll().stream()&#10;                .filter(u -&gt; userId.equals(u.getUserId()))&#10;                .count();&#10;        assertThat(count).isEqualTo(1);&#10;    }&#10;&#10;    @Test&#10;    @DisplayName(&quot;동시 가입(동일 아이디): 하나만 성공, 나머지는 400, DB에는 1건&quot;)&#10;    void concurrent_signup_same_userId_only_one_saved() throws Exception {&#10;        // given&#10;        String userId = &quot;concurrentUser01&quot;;&#10;        String rawPw = &quot;Passw0rd!&quot;;&#10;        String name = &quot;동시&quot;;&#10;        int threads = 10;&#10;        ExecutorService pool = Executors.newFixedThreadPool(threads);&#10;        CountDownLatch start = new CountDownLatch(1);&#10;        CountDownLatch done = new CountDownLatch(threads);&#10;        AtomicInteger ok = new AtomicInteger();&#10;        AtomicInteger bad = new AtomicInteger();&#10;        AtomicInteger errors = new AtomicInteger();&#10;&#10;        // when&#10;        IntStream.range(0, threads).forEach(i -&gt; pool.submit(() -&gt; {&#10;            try {&#10;                start.await();&#10;                var res = mockMvc.perform(post(&quot;/signup&quot;)&#10;                                .param(&quot;userId&quot;, userId)&#10;                                .param(&quot;password&quot;, rawPw)&#10;                                .param(&quot;passwordConfirm&quot;, rawPw)&#10;                                .param(&quot;userName&quot;, name))&#10;                        .andReturn();&#10;                int status = res.getResponse().getStatus();&#10;                if (status == 200) ok.incrementAndGet();&#10;                else if (status == 400) bad.incrementAndGet();&#10;                else errors.incrementAndGet();&#10;            } catch (Exception e) {&#10;                errors.incrementAndGet();&#10;            } finally {&#10;                done.countDown();&#10;            }&#10;        }));&#10;        start.countDown();&#10;        done.await(10, TimeUnit.SECONDS);&#10;        pool.shutdownNow();&#10;&#10;        // then&#10;        assertThat(ok.get()).isEqualTo(1);&#10;        assertThat(bad.get()).isEqualTo(threads - 1);&#10;        assertThat(errors.get()).isEqualTo(0);&#10;        long count = userRepository.findAll().stream().filter(u -&gt; userId.equals(u.getUserId())).count();&#10;        assertThat(count).isEqualTo(1);&#10;    }&#10;&#10;    @Test&#10;    @DisplayName(&quot;동시 가입(서로 다른 아이디): 모두 성공, DB에 모두 저장&quot;)&#10;    void concurrent_signup_distinct_userIds_all_saved() throws Exception {&#10;        // given&#10;        int threads = 100; &#10;        ExecutorService pool = Executors.newFixedThreadPool(threads);&#10;        CountDownLatch start = new CountDownLatch(1);&#10;        CountDownLatch done = new CountDownLatch(threads);&#10;        AtomicInteger ok = new AtomicInteger();&#10;        AtomicInteger errors = new AtomicInteger();&#10;&#10;        // when&#10;        IntStream.range(0, threads).forEach(i -&gt; pool.submit(() -&gt; {&#10;            String userId = &quot;concurrentDistinct&quot; + i;&#10;            try {&#10;                start.await();&#10;                var res = mockMvc.perform(post(&quot;/signup&quot;)&#10;                                .param(&quot;userId&quot;, userId)&#10;                                .param(&quot;password&quot;, &quot;Pw&quot; + i + &quot;!Ab1&quot;)&#10;                                .param(&quot;passwordConfirm&quot;, &quot;Pw&quot; + i + &quot;!Ab1&quot;)&#10;                                .param(&quot;userName&quot;, &quot;U&quot; + i))&#10;                        .andReturn();&#10;                int status = res.getResponse().getStatus();&#10;                if (status == 200) ok.incrementAndGet();&#10;                else errors.incrementAndGet();&#10;            } catch (Exception e) {&#10;                errors.incrementAndGet();&#10;            } finally {&#10;                done.countDown();&#10;            }&#10;        }));&#10;        long startNs = System.nanoTime();&#10;        start.countDown();&#10;        boolean finished = done.await(30, TimeUnit.SECONDS); // 완료 여부&#10;        long elapsedMs = (System.nanoTime() - startNs) / 1_000_000L;&#10;        pool.shutdownNow();&#10;        log.info(&quot;서로다른아이디 동시가입 총 경과(ms): {} / finished: {}&quot;, elapsedMs, finished);&#10;&#10;        // then&#10;        assertThat(finished).as(&quot;30초 내 전체 스레드 종료&quot;).isTrue();&#10;        assertThat(elapsedMs).isLessThanOrEqualTo(30_000);&#10;        assertThat(ok.get()).isEqualTo(threads);&#10;        assertThat(errors.get()).isEqualTo(0);&#10;        long saved = userRepository.findAll().stream()&#10;                .filter(u -&gt; u.getUserId() != null &amp;&amp; u.getUserId().startsWith(&quot;concurrentDistinct&quot;))&#10;                .count();&#10;        assertThat(saved).isEqualTo(threads);&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/SYUcap/src/test/resources/application-test.properties">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/SYUcap/src/test/resources/application-test.properties" />
              <option name="originalContent" value="spring.datasource.url=jdbc:h2:mem:testdb&#10;spring.datasource.driver-class-name=org.h2.Driver&#10;spring.datasource.username=sa&#10;spring.datasource.password=&#10;spring.jpa.hibernate.ddl-auto=create&#10;spring.jpa.properties.hibernate.show_sql=true&#10;spring.jpa.properties.hibernate.format_sql=true&#10;spring.jpa.database-platform=org.hibernate.dialect.H2Dialect&#10;spring.sql.init.mode=never&#10;&#10;# 테스트에서 스프링 시큐리티 자동설정 제외(보안 필터/구성으로 인한 컨텍스트 실패 방지)&#10;spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.security.servlet.SecurityAutoConfiguration,org.springframework.boot.autoconfigure.security.servlet.SecurityFilterAutoConfiguration,org.springframework.boot.autoconfigure.security.servlet.UserDetailsServiceAutoConfiguration&#10;&#10;# 예약어 테이블명(groups) 등 DDL 오류 방지&#10;spring.jpa.properties.hibernate.globally_quoted_identifiers=true&#10;" />
              <option name="updatedContent" value="spring.datasource.url=jdbc:h2:mem:testdb&#10;spring.datasource.driver-class-name=org.h2.Driver&#10;spring.datasource.username=sa&#10;spring.datasource.password=&#10;spring.jpa.hibernate.ddl-auto=create&#10;spring.jpa.properties.hibernate.show_sql=true&#10;spring.jpa.properties.hibernate.format_sql=true&#10;spring.jpa.database-platform=org.hibernate.dialect.H2Dialect&#10;spring.sql.init.mode=never&#10;&#10;# 예약어 테이블명(groups) 등 DDL 오류 방지&#10;spring.jpa.properties.hibernate.globally_quoted_identifiers=true" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>